define("eagle/smiley/1.0.0/smiley",["jquery/jquery/1.8.3/jquery"],function(e,t){var n=e("jquery/jquery/1.8.3/jquery"),i={textCont:"",smilies:"",emotionBox:"",emotionSrc:"",smiliesBox:{Width:"",Height:"",Border_color:""},smiliesBox_left:"",smiliesBox_top:"",smiliesBox_close:!0,insertEmoDiv_img:!0,callbacks:{intervene:function(){},insertfinish:function(){},ajaxError:function(){},ajaxSucceed:function(){}}},o=function(e){function t(){var e=m.attr("id"),t=e+"_cont01",i='<div id="'+t+'" class="emotion-box"><span class="arrow-up relative"><i class="arrow-up-innr"></i></span></div>';m.append(i),u=n("#"+t),u.css({width:x,height:_,border:"1px solid "+g,left:h,top:p})}function o(){n.ajax({url:e.emotionSrc,type:"GET",dataType:"json",timeout:1e3,cache:!1,error:function(){B(this)},success:function(e){var t=[];n.each(e,function(e,n){var i=n.title,o=n.link,l=['<img data-text="['+i+']" alt="['+i+']" title="'+i+'" src="'+o+'" />'].join("\n");t.push(l)}),m.find(".emotion-login").hide(),u.append(t.join("\n")),y.call(this)}})}function l(e,t){if(!j){var i=e;_$elemText=t,_elemText=_$elemText[0];var o=n.trim(i.attr("data-text")),l="";if(document.selection)_$elemText.focus(),l=document.selection.createRange(),l.text=o,_$elemText.focus();else if(_elemText.selectionStart||"0"==_elemText.selectionStart){var a=_elemText.selectionStart,s=_elemText.selectionEnd,c=s;_elemText.value=_elemText.value.substring(0,a)+o+_elemText.value.substring(s,_elemText.value.length),c+=o.length,_elemText.focus(),_elemText.selectionStart=c,_elemText.selectionEnd=c}else _elemText.value+=o,_$elemText.focus()}}function a(){document.all&&(this._range=document.selection.createRange())}function s(t,i){var o=t,l="",a=i;if(e.insertEmoDiv_img)if(l=o.attr("data-text"),null==a[0]._range){a[0].focus();var s=document.selection.createRange();s.text=l}else a[0]._range.text=l,document.selection.empty(),a[0]._range.collapse(),a[0]._range.select();else if(l=n("<div></div>").append(o.clone()).html(),null==a[0]._range){a[0].focus();var c=document.selection.createRange();c.pasteHTML(l)}else a[0]._range.pasteHTML(l),document.selection.empty(),a[0]._range.collapse(),a[0]._range.select()}function c(t,i){var o,l,a=t,s=i[0],c=i.attr("id");if(_elemEmoHtml=e.insertEmoDiv_img?a.attr("data-text"):n("<div></div>").append(a.clone()).html(),window.getSelection)if(o=window.getSelection(),l=o.rangeCount>0?o.getRangeAt(0):null,void 0==l||null==l||l.commonAncestorContainer.id!=c&&l.commonAncestorContainer.parentNode.id!=c);else{l.deleteContents();var r=document.createElement("div");r.innerHTML=_elemEmoHtml;for(var d,m,u=document.createDocumentFragment();d=r.firstChild;)m=u.appendChild(d);l.insertNode(u),m&&(l=l.cloneRange(),l.setStartAfter(m),l.collapse(!0),o.removeAllRanges(),o.addRange(l),s.focus())}}var e=n.extend(!0,{},i,e||{}),r=n(e.textCont),d=n(e.smilies),m=n(e.emotionBox),u=null,f=e.emotionBox+"_cont01",x=e.smiliesBox.Width,_=e.smiliesBox.Height,g=e.smiliesBox.Border_color,h=e.smiliesBox_left,p=e.smiliesBox_top,v=e.callbacks.intervene,T=e.callbacks.insertfinish,B=e.callbacks.ajaxError,y=e.callbacks.ajaxSucceed,j=r.is('[contentEditable="true"]'),k=!0,E=!0;if(!r.length||!d.length||r.length!=d.length)return null;var b=r.data("data-smiley");if("object"==typeof b)return b;var S={options:e,hand_close:function(){u.hide()}};return d.off(".add").on("click.add",function(e){E?(t(),E=!1):u.show(),e.stopPropagation(),k&&(u.append('<div class="emotion-login"></div>'),o(),k=!1)}),r.keyup(a).mouseup(a),j?m.off(".add").on("click.add","img",function(){v.call(this),document.all?s(n(this),r):c(n(this),r),T.call(this),e.smiliesBox_close&&S.hand_close()}):m.off(".add").on("click.add","img",function(){v.call(this),l(n(this),r),T.call(this),e.smiliesBox_close&&S.hand_close()}),m.off(".hide").on("click.hide",f,function(e){e.stopPropagation()}),e.smiliesBox_close&&n(document).off(".hide").on("click.hide",function(){null!==u&&u.length&&u.hide()}),r.data("data-smiley",S),S};t.render=o});